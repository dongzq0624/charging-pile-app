{"version":3,"file":"stationMap.js","sources":["sub_charging/station/stationMap/stationMap.vue","C:/Users/localadmin/Downloads/HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli-vite/uniPage:/c3ViX2NoYXJnaW5nXHN0YXRpb25cc3RhdGlvbk1hcFxzdGF0aW9uTWFwLnZ1ZQ"],"sourcesContent":["<template>\r\n\t<view class=\"whitePage\" style=\"height: 100vh;\">\r\n\t\t<jcode-navbar leftIcon=\"left\" title=\"充电地图\"></jcode-navbar>\r\n\r\n\t\t<map id=\"map\" class=\"map\" :style=\"'width: 100%;height: '+ mapHeight+'px'\" :latitude=\"latitude\" :scale=\"scale\"\r\n\t\t\t:longitude=\"longitude\" :markers=\"markers\" :show-location=\"true\" @markertap=\"onMarkerTap\"\r\n\t\t\t@callouttap=\"onMarkerTap\">\r\n\r\n\t\t\t<cover-view slot=\"callout\">\r\n\t\t\t\t<template v-for=\"item in markers\">\r\n\t\t\t\t\t<cover-view style=\"display: flex;align-items: center;font-size: 24rpx;\" :marker-id=\"item.id\">\r\n\t\t\t\t\t\t<cover-view\r\n\t\t\t\t\t\t\tstyle=\"z-index: 1; padding: 10rpx 20rpx; border-radius: 30rpx;background-color: #12A1FE;color: white;\">空闲{{stationList[item.id].freeGunNum}}</cover-view>\r\n\t\t\t\t\t\t<cover-view\r\n\t\t\t\t\t\t\tstyle=\"z-index: 0; padding: 10rpx 20rpx 10rpx 50rpx; border-radius: 30rpx;background-color: white;color: gray;margin-left: -40rpx;\">共{{stationList[item.id].totalGunNum}}</cover-view>\r\n\t\t\t\t\t</cover-view>\r\n\t\t\t\t</template>\r\n\t\t\t</cover-view>\r\n\r\n\t\t\t<!-- 自定义定位控件 -->\r\n\t\t\t<view class=\"card\" v-if=\"currentStation\">\r\n\t\t\t\t<view class=\"stationcard\" @click=\"navTo(`/sub_charging/station/stationDetail?id=${currentStation.id}`)\">\r\n\t\t\t\t\t<view class=\"stationcard-top\">\r\n\t\t\t\t\t\t<view style=\"display: flex;    align-items: center;\">\r\n\t\t\t\t\t\t\t<template v-if=\"currentStation.isFast==0\">\r\n\t\t\t\t\t\t\t\t<view class=\"label label-type1\">\r\n\t\t\t\t\t\t\t\t\t快充</view>\r\n\t\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t\t<template v-else>\r\n\t\t\t\t\t\t\t\t<view class=\"label label-type2\">\r\n\t\t\t\t\t\t\t\t\t慢充</view>\r\n\t\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t\t<view class=\"stationname\">\r\n\t\t\t\t\t\t\t\t{{currentStation.stationName}}\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t<view style=\"display: flex;align-items: center;\">\r\n\t\t\t\t\t\t\t<uni-icons type=\"location\" color=\"gray\" size=\"20\"></uni-icons>\r\n\t\t\t\t\t\t\t<view style=\"font-size: 24rpx;color: gray;\">{{numFilter(currentStation.distance,1)}}km\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t<view class=\"stationcard-middle\">\r\n\t\t\t\t\t\t<view class=\"stationcard-middle-address\">\r\n\t\t\t\t\t\t\t24小时 | 对外开放 | {{currentStation.address}}</view>\r\n\r\n\t\t\t\t\t\t<view\r\n\t\t\t\t\t\t\tstyle=\"display: flex;align-items: center;background-color: #F7F7F7;padding:15rpx 30rpx;margin-top: 20rpx;border-radius: 20rpx;\">\r\n\t\t\t\t\t\t\t<image src=\"@/static/images/tj/home/flash2.svg\" style=\"height: 25rpx;margin-right: 20rpx;\"\r\n\t\t\t\t\t\t\t\tmode=\"heightFix\"></image>\r\n\t\t\t\t\t\t\t<view style=\"font-size: 26rpx;font-weight: bold;color: #333333;\">\r\n\t\t\t\t\t\t\t\t空闲&nbsp;{{currentStation.freeGunNum}} </view>\r\n\t\t\t\t\t\t\t<view style=\"color: #989898;font-size: 22rpx;margin-left: 10rpx;\">\r\n\t\t\t\t\t\t\t\t/共&nbsp;{{currentStation.totalGunNum}}</view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t<view\r\n\t\t\t\t\t\t\tstyle=\"display: flex;justify-content: space-between;align-items: center;margin-top: 20rpx;\">\r\n\t\t\t\t\t\t\t<view class=\"stationcard-middle-fee\">\r\n\t\t\t\t\t\t\t\t{{ numFilter(currentStation.currentFee,2)}}<span\r\n\t\t\t\t\t\t\t\t\tstyle=\"font-size: 24rpx;font-weight: 300\">\r\n\t\t\t\t\t\t\t\t\t元/度</span>\r\n\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t<view class=\"stationcard-middle-chargebutton\" @tap.stop=\"toMap(currentStation)\"\r\n\t\t\t\t\t\t\t\tstyle=\"justify-content: space-between;\">\r\n\t\t\t\t\t\t\t\t<uni-icons type=\"paperplane\" size=\"16\" color=\"white\"></uni-icons>\r\n\t\t\t\t\t\t\t\t<view style=\"margin-left: 10rpx;\">导航</view>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\r\n\t\t\t<!-- 自定义定位控件 -->\r\n\t\t\t<view class=\"location-btn\" @click=\"getLocation\">\r\n\t\t\t\t<uni-icons type=\"map-pin-ellipse\" color=\"#12A1FE\" size=\"25\"></uni-icons>\r\n\t\t\t</view>\r\n\t\t</map>\r\n\t</view>\r\n</template>\r\n\r\n<script lang=\"ts\" setup>\r\n\timport {\r\n\t\tref,\r\n\t\tgetCurrentInstance,\r\n\t\tonMounted,\r\n\t\tonUnmounted\r\n\t} from \"vue\";\r\n\r\n\timport {\r\n\t\tonLoad,\r\n\t\tonShow,\r\n\t\tonReady\r\n\t} from \"@dcloudio/uni-app\";\r\n\r\n\tconst {\r\n\t\tproxy\r\n\t} = getCurrentInstance();\r\n\r\n\tconst mapHeight = ref(0)\r\n\r\n\tconst longitude = ref(null)\r\n\tconst latitude = ref(null)\r\n\tconst scale = ref(17)\r\n\r\n\tconst stationList = ref([])\r\n\tconst markers = ref([])\r\n\tconst currentStation = ref(null)\r\n\r\n\r\n\r\n\tonReady(() => {\r\n\t\tlet sysInfo = uni.getSystemInfoSync();\r\n\t\t//屏幕高度 - 顶部栏高度\r\n\t\tvar navbarHeight = sysInfo.statusBarHeight + 44\r\n\t\tmapHeight.value = sysInfo.windowHeight - navbarHeight;\r\n\t})\r\n\r\n\tonMounted(() => {\r\n\t})\r\n\r\n\tonLoad((option) => {\r\n\t\tlongitude.value = option.longitude\r\n\t\tlatitude.value = option.latitude\r\n\t\tgetAllStation()\r\n\t})\r\n\r\n\tonShow(async () => { })\r\n\r\n\tconst getLocation = async () => {\r\n\t\tcurrentStation.value = null\r\n\t\tconst newLocation = await proxy.getLocation()\r\n\t\t// 检查是否与上次位置相同\r\n\t\tif (newLocation.latitude == latitude.value &&\r\n\t\t\tnewLocation.longitude == longitude.value) {\r\n\r\n\t\t\tlatitude.value = newLocation.latitude + 0.000001\r\n\t\t\tlongitude.value = newLocation.longitude + 0.000001\r\n\t\t\tuni.__f__('log','at sub_charging/station/stationMap/stationMap.vue:141','latitude.value', latitude.value)\r\n\t\t} else {\r\n\t\t\tlatitude.value = newLocation.latitude;\r\n\t\t\tlongitude.value = newLocation.longitude;\r\n\t\t}\r\n\t\tscale.value = 17\r\n\t}\r\n\r\n\tasync function getAllStation() {\r\n\t\t//模拟接口获取所有站数据\r\n\t\tvar sList =\r\n\t\t\t[{\r\n\t\t\t\taddress: \"广东省深圳市福田区黄河路黄河大厦地下停车场\",\r\n\t\t\t\tcurrentFee: 1.69,\r\n\t\t\t\tlatitude: 22.5472,\r\n\t\t\t\tlongitude: 114.0445,\r\n\t\t\t\tstationName: \"内部测试充电站\",\r\n\t\t\t\ttotalGunNum: 2,\r\n\t\t\t\tfreeGunNum: 1\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\taddress: \"广东省深圳市福田区长江路111号\",\r\n\t\t\t\tcurrentFee: 1.19,\r\n\t\t\t\tlatitude: 21.5472,\r\n\t\t\t\tlongitude: 114.0445,\r\n\t\t\t\tstationName: \"内部测试充电站2\",\r\n\t\t\t\ttotalGunNum: 0,\r\n\t\t\t\tfreeGunNum: 2\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\taddress: \"广东省深圳市福田区长江路112号\",\r\n\t\t\t\tcurrentFee: 1.19,\r\n\t\t\t\tlatitude: 21.6472,\r\n\t\t\t\tlongitude: 114.0445,\r\n\t\t\t\tstationName: \"内部测试充电站3\",\r\n\t\t\t\ttotalGunNum: 1,\r\n\t\t\t\tfreeGunNum: 2\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\taddress: \"广东省深圳市福田区长江路113号\",\r\n\t\t\t\tcurrentFee: 1.19,\r\n\t\t\t\tlatitude: 21.5672,\r\n\t\t\t\tlongitude: 114.0445,\r\n\t\t\t\tstationName: \"内部测试充电站4\",\r\n\t\t\t\ttotalGunNum: 2,\r\n\t\t\t\tfreeGunNum: 2\r\n\t\t\t},\r\n\t\t\t]\r\n\r\n\r\n\t\t//展示到地图上 markers\r\n\t\tfor (var i = 0; i < sList.length; i++) {\r\n\t\t\tmarkers.value.push({\r\n\t\t\t\tid: i,\r\n\t\t\t\tlatitude: sList[i].latitude,\r\n\t\t\t\tlongitude: sList[i].longitude,\r\n\t\t\t\twidth: 20,\r\n\t\t\t\theight: 20,\r\n\t\t\t\tjoinCluster: true,\r\n\t\t\t\tdistance: 30,\r\n\t\t\t\tcustomCallout: {\r\n\t\t\t\t\tanchorY: 0,\r\n\t\t\t\t\tanchorX: 0,\r\n\t\t\t\t\tdisplay: 'ALWAYS',\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t}\r\n\r\n\r\n\tfunction onMarkerTap(e) {\r\n\t\tproxy.showLoading()\r\n\t\tsetTimeout(() => {\r\n\t\t\tuni.hideLoading()\r\n\t\t\tcheckStation(e.detail.markerId)\r\n\t\t}, 300)\r\n\t}\r\n\r\n\tfunction checkStation(e) {\r\n\t\tuni.__f__('log','at sub_charging/station/stationMap/stationMap.vue:221','ee')\r\n\t\tcurrentStation.value = stationList.value[e]\r\n\t\tlongitude.value = currentStation.value.longitude\r\n\t\tlatitude.value = currentStation.value.latitude\r\n\t}\r\n\r\n\tconst toMap = (item) => {\r\n\t\twx.openLocation({\r\n\t\t\tlatitude: parseFloat(item.latitude),\r\n\t\t\tlongitude: parseFloat(item.longitude),\r\n\t\t\tscale: 18,\r\n\t\t\tname: item.stationName,\r\n\t\t\taddress: item.address\r\n\t\t})\r\n\t}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n\t.location-btn {\r\n\t\tposition: absolute;\r\n\t\tbottom: 250px;\r\n\t\tright: 20px;\r\n\t\twidth: 40px;\r\n\t\theight: 40px;\r\n\t\tbackground-color: #ffffff;\r\n\t\tborder-radius: 50%;\r\n\t\tbox-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: center;\r\n\t\talign-items: center;\r\n\t\tz-index: 10;\r\n\r\n\t\t&:active {\r\n\t\t\ttransform: scale(0.98);\r\n\t\t\tbox-shadow: 0 5rpx 15rpx rgba(0, 0, 0, 0.1);\r\n\t\t}\r\n\t}\r\n\r\n\t.card {\r\n\t\tposition: absolute;\r\n\t\tbottom: 20px;\r\n\t\twidth: 100%;\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: center;\r\n\t\talign-items: center;\r\n\t\tz-index: 10;\r\n\t}\r\n\r\n\t.stationcard {\r\n\t\tbackground-color: white;\r\n\t\tmargin: 10rpx 0rpx;\r\n\t\tpadding: 30rpx;\r\n\t\twidth: 95vw;\r\n\t\tborder-radius: 20rpx;\r\n\t\tbox-shadow: 0px 0px 10px 0px rgba(253, 226, 172, 0.3);\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: center;\r\n\t\tflex-direction: column;\r\n\r\n\t\t&-top {\r\n\t\t\twidth: 100%;\r\n\t\t\tdisplay: flex;\r\n\t\t\talign-items: center;\r\n\t\t\tjustify-content: space-between;\r\n\r\n\t\t\t.label {\r\n\t\t\t\tborder-top-right-radius: 20rpx;\r\n\t\t\t\tborder-top-left-radius: 20rpx;\r\n\t\t\t\tborder-bottom-left-radius: 20rpx;\r\n\t\t\t\tpadding: 5rpx 30rpx;\r\n\t\t\t\tcolor: white;\r\n\t\t\t\tfont-size: 28rpx;\r\n\r\n\t\t\t\t&-type1 {\r\n\t\t\t\t\tbackground-image: linear-gradient(120deg, #6FD8B2 30%, #3DBE96 70%);\r\n\t\t\t\t}\r\n\r\n\t\t\t\t&-type2 {\r\n\t\t\t\t\tbackground-image: linear-gradient(120deg, #58B1F6 30%, #5598FF 70%);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t.stationname {\r\n\t\t\t\tmax-width: 45vw;\r\n\t\t\t\twhite-space: nowrap;\r\n\t\t\t\toverflow: hidden;\r\n\t\t\t\ttext-overflow: ellipsis;\r\n\t\t\t\tfont-size: 32rpx;\r\n\t\t\t\tfont-weight: bold;\r\n\t\t\t\tmargin: 0 20rpx;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t&-middle {\r\n\t\t\tdisplay: flex;\r\n\t\t\tflex-direction: column;\r\n\r\n\t\t\t&-address {\r\n\t\t\t\tfont-size: 12px;\r\n\t\t\t\tcolor: gray;\r\n\t\t\t\tmargin-top: 10px;\r\n\t\t\t\toverflow: hidden;\r\n\t\t\t\ttext-overflow: ellipsis;\r\n\t\t\t\twhite-space: nowrap;\r\n\t\t\t\twidth: 88%;\r\n\t\t\t\tmargin-left: 10rpx;\r\n\t\t\t}\r\n\r\n\t\t\t&-fee {\r\n\t\t\t\tcolor: $uni-color-theme;\r\n\t\t\t\tfont-size: 45rpx;\r\n\t\t\t\tfont-weight: bold;\r\n\t\t\t\tmargin-left: 10rpx;\r\n\t\t\t}\r\n\r\n\t\t\t&-chargebutton {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tjustify-content: center;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tfont-size: 28rpx;\r\n\t\t\t\tpadding: 0 20rpx;\r\n\t\t\t\tbackground-color: $uni-color-theme;\r\n\t\t\t\tcolor: white;\r\n\t\t\t\tpadding: 10rpx 30rpx;\r\n\t\t\t\tborder-radius: 20rpx;\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n</style>","import MiniProgramPage from 'D:/qcxn/zyd-zdc-app_1.1/sub_charging/station/stationMap/stationMap.vue'\nwx.createPage(MiniProgramPage)"],"names":["getCurrentInstance","ref","onReady","uni","onMounted","onLoad","onShow","wx"],"mappings":"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"}