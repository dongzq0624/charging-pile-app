{"version":3,"file":"system.js","sources":["utils/system.js"],"sourcesContent":["// 获取设备信息\r\nexport const getSystem = () => {\r\n\treturn new Promise(async (resolve, reject) => {\r\n\t\t// 获取系统信息\r\n\t\tconst systemInfo =uni.getSystemInfoSync();\r\n\r\n\t\t// 检查是否为App环境\r\n\t\tif (systemInfo.platform === 'android' || systemInfo.platform === 'ios') {\r\n\t\t\t// 这里是仅在App环境下运行的代码\r\n\t\t\t// 例如：特定功能、API调用、页面跳转等\r\n\t\t\tconsole.log('这段代码只在App环境下运行。');\r\n\t\t} else {\r\n\t\t\t// 这里是在非App环境下运行的代码\r\n\t\t\tconsole.log('这段代码在非App环境下运行，例如H5或小程序。');\r\n\t\t}\r\n\r\n\r\n\r\n\t\t// #ifdef MP-WEIXIN\r\n\t\tconst {\r\n\t\t\tappId,\r\n\t\t\tenvVersion,\r\n\t\t\tversion\r\n\t\t} = uni.getAccountInfoSync().miniProgram\r\n\t\t// #endif\r\n\r\n\t\t//#ifdef APP-PLUS\r\n\r\n\t\t// #endif\r\n\r\n\t\tconst safeInfo = await uni.getSystemInfoSync()\r\n\t\tresolve({\r\n\t\t\tappId,\r\n\t\t\tenvVersion,\r\n\t\t\tbottomHeight: safeInfo.safeAreaInsets.bottom,\r\n\t\t\ttopHeight: safeInfo.safeAreaInsets.top,\r\n\t\t\tuniPlatform: safeInfo.uniPlatform,\r\n\t\t\tosName: safeInfo.osName\r\n\t\t})\r\n\t})\r\n}\r\n\r\n\r\n// 计算滚动列表高度\r\nexport const calculateHeight = (domName, dataName) => {\r\n\treturn new Promise(async (resolve, reject) => {\r\n\t\tconst {\r\n\t\t\twindowHeight\r\n\t\t} = await uni.getSystemInfo()\r\n\r\n\t\tconst query = uni.createSelectorQuery()\r\n\t\tquery.select(domName).boundingClientRect()\r\n\t\tquery.exec(res => {\r\n\t\t\t// resolve((windowHeight - 60 - res[0].top) + 'px')\r\n\t\t\tresolve(windowHeight - res[0].top)\r\n\t\t})\r\n\t})\r\n}\r\n\r\n// 首页计算滚动列表高度\r\nexport const mainCalculateHeight = (domName, dataName) => {\r\n\treturn new Promise(async (resolve, reject) => {\r\n\t\tconst {\r\n\t\t\twindowHeight\r\n\t\t} = await uni.getSystemInfo()\r\n\r\n\t\tconst query = uni.createSelectorQuery()\r\n\t\tquery.select(domName).boundingClientRect()\r\n\t\tquery.exec(res => {\r\n\t\t\tresolve(windowHeight - 50 - res[0].top)\r\n\t\t})\r\n\t})\r\n}\r\n\r\n// 计算顶部栏高度\r\nexport const navBarCalculateHeight = (domName, dataName) => {\r\n\treturn new Promise(async (resolve, reject) => {\r\n\t\tconst {\r\n\t\t\twindowHeight\r\n\t\t} = await uni.getSystemInfo()\r\n\r\n\t\tconst query = uni.createSelectorQuery()\r\n\t\tquery.select(domName).boundingClientRect()\r\n\r\n\t\tquery.exec(res => {\r\n\t\t\tresolve(res[0].top)\r\n\t\t})\r\n\t})\r\n}\r\n\r\n// 格式化时间\r\nexport const resetDateTime = (time, format) => {\r\n\tconst getDate = new Date(time)\r\n\r\n\tlet o = {\r\n\t\t'MM': getDate.getMonth() + 1,\r\n\t\t'dd': getDate.getDate(),\r\n\t\t'yyyy': getDate.getFullYear(),\r\n\t\t'HH': getDate.getHours(),\r\n\t\t'mm': getDate.getMinutes(),\r\n\t\t'ss': getDate.getSeconds()\r\n\t}\r\n\r\n\treturn format.replace(/MM|dd|yyyy|HH|mm|ss/g, match => {\r\n\t\treturn o[match].toString().padStart(2, '0')\r\n\t})\r\n}\r\n\r\n// 数组/对象\r\nexport const newSet = (arr, prop, isEmpty) => {\r\n\treturn arr.filter((item, index, self) => {\r\n\t\tif (isEmpty) {\r\n\t\t\treturn self.findIndex(el => el[prop] === item[prop]) === index\r\n\t\t} else {\r\n\t\t\treturn (self.findIndex(el => el[prop] === item[prop]) === index || item[prop] === '')\r\n\t\t}\r\n\t})\r\n}\r\n\r\n// 链接跳转字段格式化\r\nexport const linkFormat = (url, data) => {\r\n\tlet format = []\r\n\r\n\tfor (let key in data) {\r\n\t\tformat.push(`${key}=${data[key]}`)\r\n\t}\r\n\r\n\treturn url + '?' + format.join('&')\r\n}\r\n\r\n/* 传参的数据进行排序处理 */\r\nexport const formatSignData = params => {\r\n\tparams = JSON.parse(JSON.stringify(params));\r\n\r\n\tlet objData = []\r\n\r\n\tfor (var key in params) {\r\n\t\tif (typeof(params[key]) === \"undefined\") {\r\n\t\t\tparams[key] = '';\r\n\t\t} else {\r\n\t\t\t// if(/%[a-fA-F0-9]{2}/.test(params[key])){\r\n\t\t\t// \tparams[key] = decodeURIcomponent(params[key])\r\n\t\t\t// } else {\r\n\t\t\t// \tparams[key] = '';\r\n\t\t\t// }\r\n\t\t\tobjData.push(`${key}=${params[key]}`)\r\n\t\t}\r\n\t}\r\n\t// console.log('format data >>> ', params)\r\n\treturn objData.join('&') + '&key=0127abceefinrtwyy';\r\n}\r\n\r\n\r\nexport const subscribe = (templateIds) => {\r\n\twx.requestSubscribeMessage({\r\n\t\ttmplIds: templateIds,\r\n\t\tsuccess(res) {\r\n\t\t\tconsole.log(\"订阅消息唤起成功 =====>\", res)\r\n\t\t},\r\n\t\tfail(err) {\r\n\t\t\tconsole.log(\"订阅消息唤起失败 =====>\", err)\r\n\t\t}\r\n\t})\r\n}\r\n\r\n"],"names":["uni","wx"],"mappings":";;AACY,MAAC,YAAY,MAAM;AAC9B,SAAO,IAAI,QAAQ,OAAO,SAAS,WAAW;AAE7C,UAAM,aAAYA,oBAAI;AAGtB,QAAI,WAAW,aAAa,aAAa,WAAW,aAAa,OAAO;AAGvEA,oBAAAA,MAAY,MAAA,OAAA,yBAAA,iBAAiB;AAAA,IAChC,OAAS;AAENA,oBAAAA,MAAY,MAAA,OAAA,yBAAA,0BAA0B;AAAA,IACtC;AAKD,UAAM;AAAA,MACL;AAAA,MACA;AAAA,MACA;AAAA,IACH,IAAMA,cAAG,MAAC,mBAAkB,EAAG;AAO7B,UAAM,WAAW,MAAMA,cAAG,MAAC,kBAAmB;AAC9C,YAAQ;AAAA,MACP;AAAA,MACA;AAAA,MACA,cAAc,SAAS,eAAe;AAAA,MACtC,WAAW,SAAS,eAAe;AAAA,MACnC,aAAa,SAAS;AAAA,MACtB,QAAQ,SAAS;AAAA,IACpB,CAAG;AAAA,EACH,CAAE;AACF;AAiHY,MAAC,YAAY,CAAC,gBAAgB;AACzCC,gBAAAA,KAAG,wBAAwB;AAAA,IAC1B,SAAS;AAAA,IACT,QAAQ,KAAK;AACZD,oBAAAA,MAAA,MAAA,OAAA,0BAAY,mBAAmB,GAAG;AAAA,IAClC;AAAA,IACD,KAAK,KAAK;AACTA,oBAAAA,MAAA,MAAA,OAAA,0BAAY,mBAAmB,GAAG;AAAA,IAClC;AAAA,EACH,CAAE;AACF;;;"}